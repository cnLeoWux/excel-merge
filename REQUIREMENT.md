# Excel Merge 需求文档

## 需求概述

指定2个Excel表格的名称，文件在当前路径的ExcelForHandel目录下

1. 第一个Excel表格是订单数据
2. 第二个表格是对应的收款和退款的明细

将第一个表格和第二个表格进行匹配，第一个表格`订单号`会重复，其中会用`订单金额`是否正数来区分是正单还是退单。收款和退款明细表格忽略前面`#`开头的行，第五行为表头。
匹配成功后修改表格1对应的字段。

## 匹配逻辑

- 第一个表格`订单号`列和第二个表格`商户订单号`列的前20位匹配，不足20位则匹配第一个表格的`外部订单号`列和第二个表格的`商品名称`列`-`后的数据。
- 第一个表格的`订单金额`列为*正数*时且不为0，该记录视为正单，执行`正单逻辑`
- 第一个表格的`订单金额`列为*负数*时且不为0，该记录视为退单，执行`退单逻辑`
- 第一个表格的`订单金额`列为0时,`支付手续费`也为0

## 正单逻辑

### 正单匹配逻辑

在匹配逻辑的基础上，检查第二个表格的`业务类型`列为`收费`的记录

### 正单数据处理

取`支出金额（-元）`列的值放到第一个表格的`支付手续费`列。

## 退单逻辑

### 退单匹配逻辑

在匹配逻辑的基础上，检查第二个表格的`业务类型`列为`退费`的记录

### 退单数据处理

取`收入金额（+元）`列的值放到第一个表格的`支付手续费`列。

## 输出

不要创建新文件，而是在表格1上修改。

## 数据样例

### 表格1

订单号：40250702110303185340，40250701232642050749， 40250709224606388514
外部订单号：P2507021103060001，P2507012326430003， P2507092246080005

### 表格2

商户订单号：2025070160562408, 2025070160570443, 2025070160578681
商品名称：吉祥旅游支付订单-P2507011154530001 , 吉祥旅游支付订单-P2507011730520002 , 吉祥旅游支付订单-P2507012326430003
